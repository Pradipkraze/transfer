import pandas as pd
import requests

# Step 1: Read the CSV file delimited by "|"
input_csv = "test.csv"
df = pd.read_csv(input_csv, delimiter="|")

# Step 2: Ensure the 'URLs' column exists
if 'URLs' not in df.columns:
    raise ValueError("The input CSV must contain a column named 'URLs'.")

# Step 3: Define a function to get the response from each URL
def fetch_url_response(url):
    try:
        # Send a GET request to the URL
        response = requests.get(url, timeout=10)  # Timeout of 10 seconds
        # Return the HTTP status code
        return response.status_code
    except requests.RequestException as e:
        # Return the error as a string if the request fails
        return f"Error: {str(e)}"

# Step 4: Apply the function to the 'URLs' column and save responses in a new column
df['Response'] = df['URLs'].apply(fetch_url_response)

# Step 5: Save the updated DataFrame back to a CSV file, delimited by "|"
output_csv = "test_output.csv"
df.to_csv(output_csv, index=False, sep="|")

print(f"Processed CSV saved to {output_csv}")
